# Data Collapse Analysis Summary

## 概述
本目录包含了使用 `datacollapse` 库对真实数据进行有限尺寸标度（finite-size scaling）分析的完整流程。

## 数据来源
- 原始数据位于 `Data_scale/L*/R/R01` 文件中
- 每个文件包含3列：U（控制参数）、Y（观测值）、sigma（误差）
- 系统尺寸：L = 7, 9, 11, 13

## 分析流程

### 1. 数据预处理
- **脚本**: `process_real_data.py`
- **功能**: 读取所有L*/R/R01文件，合并成CSV格式
- **输出**: `real_data_combined.csv` (116个数据点)

### 2. 参数探索
- **脚本**: `explore_parameters.py`
- **功能**: 手动测试不同的U_c和a值，评估坍缩质量
- **关键发现**: 
  - 最佳坍缩质量出现在 a = 1.6
  - U_c 在 8.36-8.42 范围内效果相似

### 3. FSE vs No-FSE 分析
- **脚本**: `complete_fse_analysis.py`
- **功能**: 比较有限尺寸修正（FSE）和经典方法
- **测试数据集**:
  - 全部数据 (L=7,9,11,13)
  - 去掉L=7 (L=9,11,13)
  - 去掉L=7,9 (L=11,13)

### 4. 主要结果对比

#### FSE方法（使用所有数据）
- **参数**: U_c = 8.3875 ± 0.0016, a = 1.3594 ± 0.0060
- **FSE参数**: b = 0.8531 ± 0.0108, c = -0.6219 ± 0.0454
- **坍缩质量**: 185.09
- **数据点**: 116

#### 经典方法（去掉L=7）
- **参数**: U_c = 8.6188 ± 0.0031, a = 1.0250 ± 0.0045
- **坍缩质量**: 69.91
- **数据点**: 90

## 关键发现

### 1. FSE方法明显优于经典方法
- 坍缩质量比：185.09 vs 69.91
- FSE方法能够更好地处理有限尺寸效应
- 参数不确定性更小

### 2. 有限尺寸修正的重要性
- 参数b = 0.8531表示显著的有限尺寸效应
- 参数c = -0.6219表示这些效应随系统尺寸增大而衰减
- 归一化FSE因子稳定了拟合过程

### 3. 小尺寸数据的影响
- 去掉L=7后，经典方法的坍缩质量显著下降
- 但FSE方法仍然能够处理这些数据并给出合理结果

## 推荐方案

### 主要推荐：使用FSE方法
1. **参数设置**:
   - U_c: 8.38-8.40
   - a: 1.35-1.40
   - b: 0.8-0.9
   - c: -0.6 到 -0.7

2. **拟合设置**:
   - `normalize=True` (推荐)
   - `n_knots=10`
   - `lam=1e-3`
   - `n_boot=10-20`

### 备选方案：经典方法（如果FSE不稳定）
- 去掉L=7数据
- 使用更保守的参数范围
- 增加bootstrap次数以提高稳定性

## 生成的文件

### 主要分析结果
- `plot_before_real.png` / `plot_after_real.png`: FSE方法结果
- `plot_before_no_fse.png` / `plot_after_no_fse.png`: 经典方法结果
- `fse_vs_no_fse_comparison.png`: 两种方法对比

### 参数探索结果
- `manual_collapse_test_Uc*.png`: 不同参数组合的坍缩测试
- `no_fse_analysis.png`: 无FSE方法分析

## 使用建议

### 1. 正式分析
- 使用 `run_real.py` 进行FSE分析
- 基于探索结果调整初始参数
- 考虑增加bootstrap次数以提高统计可靠性

### 2. 参数调优
- 如果拟合不稳定，尝试调整 `lam` 参数
- 如果坍缩质量不佳，检查参数边界设置
- 考虑使用 `--robust` 选项进行网格搜索

### 3. 结果验证
- 检查坍缩后的曲线是否真正重合
- 验证参数的不确定性是否合理
- 考虑物理意义是否合理

## 注意事项

1. **matplotlib标签**: 避免在标签和标题中使用中文字符
2. **数据质量**: 确保误差估计的准确性
3. **系统尺寸**: 考虑是否覆盖了足够的尺寸范围
4. **统计显著性**: 使用足够的bootstrap次数

## 后续工作

1. **参数敏感性分析**: 研究参数变化对结果的影响
2. **误差传播**: 分析误差如何影响最终参数
3. **模型选择**: 比较不同FSE模型的效果
4. **物理解释**: 将拟合结果与理论预期对比 